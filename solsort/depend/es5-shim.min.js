// vim: ts=4 sts=4 sw=4 expandtab
// -- kriskowal Kris Kowal Copyright (C) 2009-2011 MIT License
// -- tlrobinson Tom Robinson Copyright (C) 2009-2010 MIT License (Narwhal Project)
// -- dantman Daniel Friesen Copyright (C) 2010 XXX TODO License or CLA
// -- fschaefer Florian Schäfer Copyright (C) 2010 MIT License
// -- Gozala Irakli Gozalishvili Copyright (C) 2010 MIT License
// -- kitcambridge Kit Cambridge Copyright (C) 2011 MIT License
// -- kossnocorp Sasha Koss XXX TODO License or CLA
// -- bryanforbes Bryan Forbes XXX TODO License or CLA
// -- killdream Quildreen Motta Copyright (C) 2011 MIT Licence
// -- michaelficarra Michael Ficarra Copyright (C) 2011 3-clause BSD License
// -- sharkbrainguy Gerard Paapu Copyright (C) 2011 MIT License
// -- bbqsrc Brendan Molloy (C) 2011 Creative Commons Zero (public domain)
// -- iwyg XXX TODO License or CLA
// -- DomenicDenicola Domenic Denicola Copyright (C) 2011 MIT License
// -- xavierm02 Montillet Xavier Copyright (C) 2011 MIT License
// -- Raynos Jake Verbaten Copyright (C) 2011 MIT Licence
// -- samsonjs Sami Samhuri Copyright (C) 2010 MIT License
// -- rwldrn Rick Waldron Copyright (C) 2011 MIT License
// -- lexer Alexey Zakharov XXX TODO License or CLA
/*!
    Copyright (c) 2009, 280 North Inc. http://280north.com/
    MIT License. http://github.com/280north/narwhal/blob/master/README.md
*/// Module systems magic dance
(function(a){typeof define=="function"?define(a):a()})(function(){function m(a){try{return Object.defineProperty(a,"sentinel",{}),"sentinel"in a}catch(b){}}Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError("Function.prototype.bind called on incompatible "+c);var e=d.call(arguments,1),f=function(){if(this instanceof f){var a=function(){};a.prototype=c.prototype;var g=new a,h=c.apply(g,e.concat(d.call(arguments)));return Object(h)===h?h:g}return c.apply(b,e.concat(d.call(arguments)))};return f});var a=Function.prototype.call,b=Array.prototype,c=Object.prototype,d=b.slice,e=a.bind(c.toString),f=a.bind(c.hasOwnProperty),g,h,i,j,k;if(k=f(c,"__defineGetter__"))g=a.bind(c.__defineGetter__),h=a.bind(c.__defineSetter__),i=a.bind(c.__lookupGetter__),j=a.bind(c.__lookupSetter__);Array.isArray||(Array.isArray=function(b){return e(b)=="[object Array]"}),Array.prototype.forEach||(Array.prototype.forEach=function(b){var c=D(this),d=arguments[1],f=-1,g=c.length>>>0;if(e(b)!="[object Function]")throw new TypeError;while(++f<g)f in c&&b.call(d,c[f],f,c)}),Array.prototype.map||(Array.prototype.map=function(b){var c=D(this),d=c.length>>>0,f=Array(d),g=arguments[1];if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");for(var h=0;h<d;h++)h in c&&(f[h]=b.call(g,c[h],h,c));return f}),Array.prototype.filter||(Array.prototype.filter=function(b){var c=D(this),d=c.length>>>0,f=[],g,h=arguments[1];if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");for(var i=0;i<d;i++)i in c&&(g=c[i],b.call(h,g,i,c)&&f.push(g));return f}),Array.prototype.every||(Array.prototype.every=function(b){var c=D(this),d=c.length>>>0,f=arguments[1];if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");for(var g=0;g<d;g++)if(g in c&&!b.call(f,c[g],g,c))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(b){var c=D(this),d=c.length>>>0,f=arguments[1];if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");for(var g=0;g<d;g++)if(g in c&&b.call(f,c[g],g,c))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(b){var c=D(this),d=c.length>>>0;if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");if(!d&&arguments.length==1)throw new TypeError("reduce of empty array with no initial value");var f=0,g;if(arguments.length>=2)g=arguments[1];else do{if(f in c){g=c[f++];break}if(++f>=d)throw new TypeError("reduce of empty array with no initial value")}while(!0);for(;f<d;f++)f in c&&(g=b.call(void 0,g,c[f],f,c));return g}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(b){var c=D(this),d=c.length>>>0;if(e(b)!="[object Function]")throw new TypeError(b+" is not a function");if(!d&&arguments.length==1)throw new TypeError("reduceRight of empty array with no initial value");var f,g=d-1;if(arguments.length>=2)f=arguments[1];else do{if(g in c){f=c[g--];break}if(--g<0)throw new TypeError("reduceRight of empty array with no initial value")}while(!0);do g in this&&(f=b.call(void 0,f,c[g],g,c));while(g--);return f}),Array.prototype.indexOf||(Array.prototype.indexOf=function(b){var c=D(this),d=c.length>>>0;if(!d)return-1;var e=0;arguments.length>1&&(e=B(arguments[1])),e=e>=0?e:Math.max(0,d+e);for(;e<d;e++)if(e in c&&c[e]===b)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(b){var c=D(this),d=c.length>>>0;if(!d)return-1;var e=d-1;arguments.length>1&&(e=Math.min(e,B(arguments[1]))),e=e>=0?e:d-Math.abs(e);for(;e>=0;e--)if(e in c&&b===c[e])return e;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(b){return b.__proto__||(b.constructor?b.constructor.prototype:c)});if(!Object.getOwnPropertyDescriptor){var l="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(b,d){if(typeof b!="object"&&typeof b!="function"||b===null)throw new TypeError(l+b);if(!f(b,d))return;var e={enumerable:!0,configurable:!0};if(k){var g=b.__proto__;b.__proto__=c;var h=i(b,d),m=j(b,d);b.__proto__=g;if(h||m)return h&&(e.get=h),m&&(e.set=m),e}return e.value=b[d],e}}Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(b){return Object.keys(b)}),Object.create||(Object.create=function(b,c){var d;if(b===null)d={__proto__:null};else{if(typeof b!="object")throw new TypeError("typeof prototype["+typeof b+"] != 'object'");var e=function(){};e.prototype=b,d=new e,d.__proto__=b}return c!==void 0&&Object.defineProperties(d,c),d});if(Object.defineProperty){var n=m({}),o=typeof document=="undefined"||m(document.createElement("div"));if(!n||!o)var p=Object.defineProperty}if(!Object.defineProperty||p){var q="Property description must be an object: ",r="Object.defineProperty called on non-object: ",s="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(b,d,e){if(typeof b!="object"&&typeof b!="function"||b===null)throw new TypeError(r+b);if(typeof e!="object"&&typeof e!="function"||e===null)throw new TypeError(q+e);if(p)try{return p.call(Object,b,d,e)}catch(l){}if(f(e,"value"))if(k&&(i(b,d)||j(b,d))){var m=b.__proto__;b.__proto__=c,delete b[d],b[d]=e.value,b.__proto__=m}else b[d]=e.value;else{if(!k)throw new TypeError(s);f(e,"get")&&g(b,d,e.get),f(e,"set")&&h(b,d,e.set)}return b}}Object.defineProperties||(Object.defineProperties=function(b,c){for(var d in c)f(c,d)&&d!="__proto__"&&Object.defineProperty(b,d,c[d]);return b}),Object.seal||(Object.seal=function(b){return b}),Object.freeze||(Object.freeze=function(b){return b});try{Object.freeze(function(){})}catch(t){Object.freeze=function(b){return function(c){return typeof c=="function"?c:b(c)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(b){return b}),Object.isSealed||(Object.isSealed=function(b){return!1}),Object.isFrozen||(Object.isFrozen=function(b){return!1}),Object.isExtensible||(Object.isExtensible=function(b){if(Object(b)===b)throw new TypeError;var c="";while(f(b,c))c+="?";b[c]=!0;var d=f(b,c);return delete b[c],d});if(!Object.keys){var u=!0,v=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],w=v.length;for(var x in{toString:null})u=!1;Object.keys=function E(a){if(typeof a!="object"&&typeof a!="function"||a===null)throw new TypeError("Object.keys called on a non-object");var E=[];for(var b in a)f(a,b)&&E.push(b);if(u)for(var c=0,d=w;c<d;c++){var e=v[c];f(a,e)&&E.push(e)}return E}}if(!Date.prototype.toISOString||(new Date(-621987552e5)).toISOString().indexOf("-000001")===-1)Date.prototype.toISOString=function(){var b,c,d,e;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");b=[this.getUTCMonth()+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],e=this.getUTCFullYear(),e=(e<0?"-":e>9999?"+":"")+("00000"+Math.abs(e)).slice(0<=e&&e<=9999?-4:-6),c=b.length;while(c--)d=b[c],d<10&&(b[c]="0"+d);return e+"-"+b.slice(0,2).join("-")+"T"+b.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"};Date.now||(Date.now=function(){return(new Date).getTime()}),Date.prototype.toJSON||(Date.prototype.toJSON=function(b){if(typeof this.toISOString!="function")throw new TypeError("toISOString property is not callable");return this.toISOString()});if(!Date.parse||Date.parse("+275760-09-13T00:00:00.000Z")!==864e13)Date=function(a){var b=function e(b,c,d,f,g,h,i){var j=arguments.length;if(this instanceof a){var k=j==1&&String(b)===b?new a(e.parse(b)):j>=7?new a(b,c,d,f,g,h,i):j>=6?new a(b,c,d,f,g,h):j>=5?new a(b,c,d,f,g):j>=4?new a(b,c,d,f):j>=3?new a(b,c,d):j>=2?new a(b,c):j>=1?new a(b):new a;return k.constructor=e,k}return a.apply(this,arguments)},c=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$");for(var d in a)b[d]=a[d];return b.now=a.now,b.UTC=a.UTC,b.prototype=a.prototype,b.prototype.constructor=b,b.parse=function(d){var e=c.exec(d);if(e){e.shift();for(var f=1;f<7;f++)e[f]=+(e[f]||(f<3?1:0)),f==1&&e[f]--;var g=+e.pop(),h=+e.pop(),i=e.pop(),j=0;if(i){if(h>23||g>59)return NaN;j=(h*60+g)*6e4*(i=="+"?-1:1)}var k=+e[0];return 0<=k&&k<=99?(e[0]=k+400,a.UTC.apply(this,e)+j-126227808e5):a.UTC.apply(this,e)+j}return a.parse.apply(this,arguments)},b}(Date);var y="\t\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||y.trim()){y="["+y+"]";var z=new RegExp("^"+y+y+"*"),A=new RegExp(y+y+"*$");String.prototype.trim=function(){if(this===undefined||this===null)throw new TypeError("can't convert "+this+" to object");return String(this).replace(z,"").replace(A,"")}}var B=function(a){return a=+a,a!==a?a=0:a!==0&&a!==1/0&&a!==-Infinity&&(a=(a>0||-1)*Math.floor(Math.abs(a))),a},C="a"[0]!="a",D=function(a){if(a==null)throw new TypeError("can't convert "+a+" to object");return C&&typeof a=="string"&&a?a.split(""):Object(a)}});